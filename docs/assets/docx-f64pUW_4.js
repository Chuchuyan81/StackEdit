const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mammoth.browser-CCY3QUr-.js","assets/index-Avj-ad0q.js","assets/index-Cooxojf_.css","assets/index-_KkjX4xT.js"])))=>i.map(i=>d[i]);
import{_ as i}from"./index-Avj-ad0q.js";async function m(){const a=[()=>i(()=>import("./mammoth.browser-CCY3QUr-.js").then(n=>n.m),__vite__mapDeps([0,1,2])),()=>i(()=>import("./mammoth.browser-CCY3QUr-.js").then(n=>n.m),__vite__mapDeps([0,1,2])),()=>i(()=>import("./index-_KkjX4xT.js").then(n=>n.i),__vite__mapDeps([3,1,2]))];let e=null;for(const n of a)try{const t=await n(),r=(t==null?void 0:t.default)??(t==null?void 0:t.mammoth)??t;if(r&&typeof r.convertToHtml=="function")return r}catch(t){e=t}throw e||new Error("Не удалось загрузить mammoth")}async function s(a){const e=await i(()=>import("./turndown.browser.es-DqC8V-Us.js"),[]),n=(e==null?void 0:e.default)??e,t=await i(()=>import("./turndown-plugin-gfm.es-DzXe-JUf.js"),[]),r=(t==null?void 0:t.gfm)??(t==null?void 0:t.default)??t,o=new n({headingStyle:"atx",codeBlockStyle:"fenced",bulletListMarker:"-",emDelimiter:"*"});return r&&o.use(r),o.addRule("preserve-line-breaks",{filter:["br"],replacement:()=>`  
`}),o.turndown(String(a??""))}async function l(a){const e=await m(),n=await e.convertToHtml({arrayBuffer:a},{convertImage:e.images.inline(function(o){return o.read("base64").then(function(c){return{src:`data:${o.contentType||"image/png"};base64,${c}`}})})}),t=(n==null?void 0:n.value)??"",r=await s(t);return String(r||"").trim()}export{l as convertDocxArrayBufferToMarkdown};
