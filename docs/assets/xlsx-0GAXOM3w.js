const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-w7OJ2kAj.js","assets/index-BPNXpCOL.css"])))=>i.map(i=>d[i]);
import{_ as h}from"./index-w7OJ2kAj.js";async function d(){const t=await h(()=>import("./index-w7OJ2kAj.js").then(e=>e.B),__vite__mapDeps([0,1]));return t&&typeof t.read=="function"?t:t!=null&&t.default&&typeof t.default.read=="function"?t.default:(t==null?void 0:t.default)??t}function y(t){const e=Array.isArray(t)?t:[];if(e.length===0)return"";const s=e.reduce((r,o)=>Math.max(r,Array.isArray(o)?o.length:0),0),n=r=>r==null?"":String(r).replace(/\|/g,"\\|"),a=r=>`| ${r.join(" | ")} |`,i=Array.from({length:s},(r,o)=>{var f;return n(((f=e[0])==null?void 0:f[o])??"")}),u=Array.from({length:s},()=>"---"),c=e.slice(1).map(r=>{const o=Array.from({length:s},(f,l)=>n((r==null?void 0:r[l])??""));return a(o)});return[a(i),a(u),...c].join(`
`)}async function _(t){const e=await d();console.log("XLSX загружен:",typeof e,"имеет utils:",!!(e!=null&&e.utils));const s=e.read(t,{type:"array"}),n=[];for(const a of s.SheetNames){const i=s.Sheets[a],u=e.utils.sheet_to_json(i,{header:1,raw:!0,blankrows:!1}),c=y(u);c&&(n.push(`## ${a}`),n.push(""),n.push(c),n.push(""))}return n.join(`
`)}export{_ as convertSpreadsheetArrayBufferToMarkdown};
