const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mammoth.browser-Dl2_jrH6.js","assets/index-BAbs46vA.js","assets/index-Bj0_rAGV.css","assets/index-CAKzInye.js"])))=>i.map(i=>d[i]);
import{_ as i}from"./index-BAbs46vA.js";async function m(){const a=[()=>i(()=>import("./mammoth.browser-Dl2_jrH6.js").then(e=>e.m),__vite__mapDeps([0,1,2])),()=>i(()=>import("./mammoth.browser-Dl2_jrH6.js").then(e=>e.m),__vite__mapDeps([0,1,2])),()=>i(()=>import("./index-CAKzInye.js").then(e=>e.i),__vite__mapDeps([3,1,2]))];let o=null;for(const e of a)try{const t=await e(),n=(t==null?void 0:t.default)??(t==null?void 0:t.mammoth)??t;if(n&&typeof n.convertToHtml=="function")return n}catch(t){o=t}throw o||new Error("Не удалось загрузить mammoth")}async function s(a){const o=await i(()=>import("./turndown.browser.es-DqC8V-Us.js"),[]),e=(o==null?void 0:o.default)??o;console.log("TurndownService загружен:",typeof e);const t=await i(()=>import("./turndown-plugin-gfm.es-DzXe-JUf.js"),[]),n=(t==null?void 0:t.gfm)??(t==null?void 0:t.default)??t;console.log("GFM плагин загружен:",typeof n);const r=new e({headingStyle:"atx",codeBlockStyle:"fenced",bulletListMarker:"-",emDelimiter:"*"});return typeof n=="function"?r.use(n):n&&typeof n.gfm=="function"?r.use(n.gfm):console.warn("GFM плагин не является функцией, пропускаем"),r.addRule("preserve-line-breaks",{filter:["br"],replacement:()=>`  
`}),r.turndown(String(a??""))}async function l(a){const o=await m(),e=await o.convertToHtml({arrayBuffer:a},{convertImage:o.images.inline(function(r){return r.read("base64").then(function(c){return{src:`data:${r.contentType||"image/png"};base64,${c}`}})})}),t=(e==null?void 0:e.value)??"",n=await s(t);return String(n||"").trim()}export{l as convertDocxArrayBufferToMarkdown};
